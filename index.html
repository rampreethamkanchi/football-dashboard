<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Dashboard</title>
    <style>
        /* Design System - CSS Variables */
        :root {
            /* Colors */
            --color-background: #fcfcf9;
            --color-surface: #fffffd;
            --color-text: #13343b;
            --color-text-secondary: #626c71;
            --color-primary: #21808d;
            --color-primary-hover: #1d7480;
            --color-border: rgba(94, 82, 64, 0.2);
            --color-card-border: rgba(94, 82, 64, 0.12);
            --color-success: #21808d;
            --color-error: #c0152f;
            --color-warning: #a84b2f;
            
            /* Status colors */
            --color-live: #c0152f;
            --color-live-bg: rgba(192, 21, 47, 0.1);
            
            /* Typography */
            --font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            
            /* Spacing */
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            
            /* Border Radius */
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-lg: 12px;
            --radius-full: 9999px;
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }

        /* Dark mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: #1f2121;
                --color-surface: #262828;
                --color-text: #f5f5f5;
                --color-text-secondary: rgba(167, 169, 169, 0.7);
                --color-primary: #32b8c6;
                --color-primary-hover: #2da5b2;
                --color-border: rgba(119, 124, 124, 0.3);
                --color-card-border: rgba(119, 124, 124, 0.2);
                --color-live-bg: rgba(255, 84, 89, 0.15);
            }
        }

        /* Base styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            line-height: 1.5;
            color: var(--color-text);
            background-color: var(--color-background);
            padding: var(--space-20);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            font-size: var(--font-size-3xl);
            font-weight: 600;
            margin-bottom: var(--space-8);
            color: var(--color-text);
        }

        .subtitle {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-32);
        }

        .section {
            margin-bottom: var(--space-32);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-16);
        }

        .section-title {
            font-size: var(--font-size-xl);
            font-weight: 600;
            color: var(--color-text);
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--space-8);
            padding: 4px 12px;
            background-color: var(--color-live-bg);
            color: var(--color-live);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: 500;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background-color: var(--color-live);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .fixtures-grid {
            display: grid;
            gap: var(--space-16);
        }

        .fixture-card {
            background-color: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s ease;
        }

        .fixture-card:hover {
            box-shadow: var(--shadow-md);
        }

        .fixture-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-16);
            padding-bottom: var(--space-12);
            border-bottom: 1px solid var(--color-border);
        }

        .league-name {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            font-weight: 500;
        }

        .fixture-time {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .teams-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-16);
        }

        .team {
            flex: 1;
            display: flex;
            align-items: center;
            gap: var(--space-12);
        }

        .team.away {
            flex-direction: row-reverse;
            text-align: right;
        }

        .team-logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
            flex-shrink: 0;
        }

        .team-info {
            flex: 1;
            min-width: 0;
        }

        .team-name {
            font-size: var(--font-size-base);
            font-weight: 500;
            color: var(--color-text);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .score-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 80px;
        }

        .score {
            font-size: var(--font-size-2xl);
            font-weight: 600;
            color: var(--color-text);
            display: flex;
            gap: var(--space-8);
            align-items: center;
        }

        .status-badge {
            margin-top: var(--space-8);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: var(--font-size-xs);
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-badge.live {
            background-color: var(--color-live-bg);
            color: var(--color-live);
        }

        .status-badge.finished {
            background-color: rgba(var(--color-text-secondary), 0.1);
            color: var(--color-text-secondary);
        }

        .status-badge.scheduled {
            background-color: rgba(var(--color-primary), 0.1);
            color: var(--color-primary);
        }

        .loading {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }

        .spinner {
            border: 3px solid var(--color-border);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--space-16);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            background-color: rgba(192, 21, 47, 0.1);
            border: 1px solid var(--color-error);
            border-radius: var(--radius-base);
            padding: var(--space-16);
            color: var(--color-error);
            margin-bottom: var(--space-16);
        }

        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-16);
        }

        @media (max-width: 768px) {
            body {
                padding: var(--space-12);
            }

            h1 {
                font-size: var(--font-size-2xl);
            }

            .team-name {
                font-size: var(--font-size-sm);
            }

            .team-logo {
                width: 32px;
                height: 32px;
            }

            .score {
                font-size: var(--font-size-xl);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>⚽ Football Dashboard</h1>
            <p class="subtitle">Your favorite teams in Indian Standard Time</p>
        </header>

        <main>
            <!-- Live Matches Section -->
            <section class="section" id="live-section">
                <div class="section-header">
                    <h2 class="section-title">Live Matches</h2>
                    <div class="live-indicator">
                        <span class="live-dot"></span>
                        <span>LIVE</span>
                    </div>
                </div>
                <div id="live-matches" class="fixtures-grid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading live matches...</p>
                    </div>
                </div>
            </section>

            <!-- Recent Results Section -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">Recent Results</h2>
                </div>
                <div id="recent-results" class="fixtures-grid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading recent results...</p>
                    </div>
                </div>
            </section>

            <!-- Upcoming Fixtures Section -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">Upcoming Fixtures</h2>
                </div>
                <div id="upcoming-fixtures" class="fixtures-grid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading upcoming fixtures...</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        /**
         * Configuration object for the Football Dashboard
         * Modify these settings to customize which teams and leagues you follow
         */
        const CONFIG = {
            // Your API-Football API key
            API_KEY: '54f57dbc5e8d1622e9eeed74d03c2f88',
            
            // Base URL for API requests
            API_BASE_URL: 'https://v3.football.api-sports.io',
            
            // Timezone for displaying match times (Indian Standard Time)
            TIMEZONE: 'Asia/Kolkata',
            
            // Array of team IDs you want to follow
            // To find team IDs, visit: https://dashboard.api-football.com
            FAVORITE_TEAMS: [
                33,  // Manchester United
                40,  // Liverpool
                50,  // Manchester City
                42,  // Arsenal
                529, // Barcelona
                541  // Real Madrid
            ],
            
            // Optional: Filter by specific leagues (leave empty array to show all leagues)
            // Common league IDs: Premier League (39), La Liga (140), Champions League (2)
            FAVORITE_LEAGUES: [],
            
            // Number of days to look back for recent results
            RECENT_DAYS_BACK: 2,
            
            // Number of days to look ahead for upcoming fixtures
            UPCOMING_DAYS_AHEAD: 2
        };

        /**
         * Makes an API request to API-Football
         * @param {string} endpoint - API endpoint path
         * @returns {Promise<Object>} API response data
         */
        async function apiRequest(endpoint) {
            try {
                const response = await fetch(`${CONFIG.API_BASE_URL}${endpoint}`, {
                    method: 'GET',
                    headers: {
                        'x-apisports-key': CONFIG.API_KEY
                    }
                });

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                
                if (data.errors && Object.keys(data.errors).length > 0) {
                    throw new Error(`API error: ${JSON.stringify(data.errors)}`);
                }

                return data;
            } catch (error) {
                console.error('API request error:', error);
                throw error;
            }
        }

        /**
         * Formats a date string to relative day (Today, Yesterday, Tomorrow) with time
         * @param {string} dateString - ISO date string
         * @returns {string} Formatted date/time string
         */
        function formatFixtureTime(dateString) {
            const fixtureDate = new Date(dateString);
            const now = new Date();
            
            // Set times to midnight for date comparison
            const fixtureDateOnly = new Date(fixtureDate.getFullYear(), fixtureDate.getMonth(), fixtureDate.getDate());
            const todayOnly = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            
            // Calculate difference in days
            const diffTime = fixtureDateOnly - todayOnly;
            const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));
            
            // Format time
            const timeStr = fixtureDate.toLocaleTimeString('en-IN', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true,
                timeZone: CONFIG.TIMEZONE
            });
            
            // Determine day label
            let dayLabel;
            if (diffDays === 0) {
                dayLabel = 'Today';
            } else if (diffDays === -1) {
                dayLabel = 'Yesterday';
            } else if (diffDays === 1) {
                dayLabel = 'Tomorrow';
            } else if (diffDays === -2) {
                dayLabel = 'Day before yesterday';
            } else if (diffDays === 2) {
                dayLabel = 'Day after tomorrow';
            } else {
                // For dates further out, show day of week
                dayLabel = fixtureDate.toLocaleDateString('en-IN', { weekday: 'long' });
            }
            
            return `${dayLabel} ${timeStr}`;
        }

        /**
         * Checks if a fixture involves any of the user's favorite teams
         * @param {Object} fixture - Fixture object from API
         * @returns {boolean} True if fixture involves a favorite team
         */
        function isMyTeam(fixture) {
            const homeTeamId = fixture.teams.home.id;
            const awayTeamId = fixture.teams.away.id;
            return CONFIG.FAVORITE_TEAMS.includes(homeTeamId) || CONFIG.FAVORITE_TEAMS.includes(awayTeamId);
        }

        /**
         * Checks if a fixture is in a favorite league (if leagues filter is set)
         * @param {Object} fixture - Fixture object from API
         * @returns {boolean} True if fixture is in a favorite league or no league filter is set
         */
        function isMyLeague(fixture) {
            if (CONFIG.FAVORITE_LEAGUES.length === 0) return true;
            return CONFIG.FAVORITE_LEAGUES.includes(fixture.league.id);
        }

        /**
         * Filters fixtures to only include user's favorite teams and leagues
         * @param {Array} fixtures - Array of fixture objects
         * @returns {Array} Filtered fixtures
         */
        function filterMyFixtures(fixtures) {
            return fixtures.filter(fixture => isMyTeam(fixture) && isMyLeague(fixture));
        }

        /**
         * Gets the status badge HTML for a fixture
         * @param {Object} fixture - Fixture object
         * @returns {string} HTML string for status badge
         */
        function getStatusBadge(fixture) {
            const status = fixture.fixture.status.short;
            const elapsed = fixture.fixture.status.elapsed;

            // Live statuses
            const liveStatuses = ['1H', '2H', 'HT', 'ET', 'BT', 'P', 'SUSP', 'INT', 'LIVE'];
            if (liveStatuses.includes(status)) {
                const displayText = elapsed ? `${elapsed}'` : 'LIVE';
                return `<span class="status-badge live">${displayText}</span>`;
            }

            // Finished statuses
            const finishedStatuses = ['FT', 'AET', 'PEN'];
            if (finishedStatuses.includes(status)) {
                return `<span class="status-badge finished">${status}</span>`;
            }

            // Scheduled
            return `<span class="status-badge scheduled">${status}</span>`;
        }

        /**
         * Creates HTML for a fixture card
         * @param {Object} fixture - Fixture object from API
         * @returns {string} HTML string for fixture card
         */
        function createFixtureCard(fixture) {
            const homeTeam = fixture.teams.home;
            const awayTeam = fixture.teams.away;
            const homeScore = fixture.goals.home !== null ? fixture.goals.home : '-';
            const awayScore = fixture.goals.away !== null ? fixture.goals.away : '-';
            const time = formatFixtureTime(fixture.fixture.date);
            const leagueName = `${fixture.league.name} - ${fixture.league.round || ''}`;

            return `
                <div class="fixture-card">
                    <div class="fixture-header">
                        <span class="league-name">${leagueName}</span>
                        <span class="fixture-time">${time}</span>
                    </div>
                    <div class="teams-container">
                        <div class="team home">
                            <img src="${homeTeam.logo}" alt="${homeTeam.name}" class="team-logo" onerror="this.style.display='none'">
                            <div class="team-info">
                                <div class="team-name">${homeTeam.name}</div>
                            </div>
                        </div>
                        <div class="score-container">
                            <div class="score">
                                <span>${homeScore}</span>
                                <span>-</span>
                                <span>${awayScore}</span>
                            </div>
                            ${getStatusBadge(fixture)}
                        </div>
                        <div class="team away">
                            <img src="${awayTeam.logo}" alt="${awayTeam.name}" class="team-logo" onerror="this.style.display='none'">
                            <div class="team-info">
                                <div class="team-name">${awayTeam.name}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Displays fixtures in a container
         * @param {string} containerId - ID of the container element
         * @param {Array} fixtures - Array of fixture objects
         * @param {string} emptyMessage - Message to show when no fixtures found
         */
        function displayFixtures(containerId, fixtures, emptyMessage) {
            const container = document.getElementById(containerId);
            
            if (fixtures.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">⚽</div>
                        <p>${emptyMessage}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = fixtures.map(createFixtureCard).join('');
        }

        /**
         * Displays an error message in a container
         * @param {string} containerId - ID of the container element
         * @param {string} message - Error message to display
         */
        function displayError(containerId, message) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="error">
                    <strong>Error:</strong> ${message}
                </div>
            `;
        }

        /**
         * Gets the date string for a specific number of days offset from today
         * @param {number} daysOffset - Number of days to offset (negative for past, positive for future)
         * @returns {string} Date string in YYYY-MM-DD format
         */
        function getDateString(daysOffset = 0) {
            const date = new Date();
            date.setDate(date.getDate() + daysOffset);
            return date.toISOString().split('T')[0];
        }

        /**
         * Fetches and displays live matches
         */
        async function loadLiveMatches() {
            try {
                const data = await apiRequest(`/fixtures?live=all&timezone=${CONFIG.TIMEZONE}`);
                const myFixtures = filterMyFixtures(data.response);
                displayFixtures('live-matches', myFixtures, 'No live matches at the moment');
                
                // Hide the live section if no matches
                if (myFixtures.length === 0) {
                    document.getElementById('live-section').style.display = 'none';
                }
            } catch (error) {
                displayError('live-matches', 'Failed to load live matches. Please check your API key and try again.');
                console.error('Error loading live matches:', error);
            }
        }

        /**
         * Fetches and displays recent results
         */
        async function loadRecentResults() {
            try {
                const fixtures = [];
                
                // Fetch fixtures from the past days
                for (let i = 0; i < CONFIG.RECENT_DAYS_BACK; i++) {
                    const date = getDateString(-i);
                    const data = await apiRequest(`/fixtures?date=${date}&timezone=${CONFIG.TIMEZONE}`);
                    fixtures.push(...data.response);
                }

                // Filter for my teams and finished matches
                const finishedStatuses = ['FT', 'AET', 'PEN'];
                const myFinishedFixtures = fixtures.filter(fixture => 
                    isMyTeam(fixture) && 
                    isMyLeague(fixture) &&
                    finishedStatuses.includes(fixture.fixture.status.short)
                );

                // Sort by date (most recent first)
                myFinishedFixtures.sort((a, b) => 
                    new Date(b.fixture.date) - new Date(a.fixture.date)
                );

                displayFixtures('recent-results', myFinishedFixtures, 'No recent results found');
            } catch (error) {
                displayError('recent-results', 'Failed to load recent results. Please check your API key and try again.');
                console.error('Error loading recent results:', error);
            }
        }

        /**
         * Fetches and displays upcoming fixtures
         */
        async function loadUpcomingFixtures() {
            try {
                const fixtures = [];
                
                // Fetch fixtures for upcoming days
                for (let i = 0; i <= CONFIG.UPCOMING_DAYS_AHEAD; i++) {
                    const date = getDateString(i);
                    const data = await apiRequest(`/fixtures?date=${date}&timezone=${CONFIG.TIMEZONE}`);
                    fixtures.push(...data.response);
                }

                // Filter for my teams and scheduled matches
                const scheduledStatuses = ['TBD', 'NS'];
                const myScheduledFixtures = fixtures.filter(fixture => 
                    isMyTeam(fixture) && 
                    isMyLeague(fixture) &&
                    scheduledStatuses.includes(fixture.fixture.status.short)
                );

                // Sort by date (earliest first)
                myScheduledFixtures.sort((a, b) => 
                    new Date(a.fixture.date) - new Date(b.fixture.date)
                );

                displayFixtures('upcoming-fixtures', myScheduledFixtures, 'No upcoming fixtures found');
            } catch (error) {
                displayError('upcoming-fixtures', 'Failed to load upcoming fixtures. Please check your API key and try again.');
                console.error('Error loading upcoming fixtures:', error);
            }
        }

        /**
         * Initializes the dashboard by loading all sections
         */
        async function initDashboard() {
            console.log('Initializing Football Dashboard...');
            console.log(`Tracking teams: ${CONFIG.FAVORITE_TEAMS.join(', ')}`);
            
            // Load all sections in parallel
            await Promise.all([
                loadLiveMatches(),
                loadRecentResults(),
                loadUpcomingFixtures()
            ]);

            console.log('Dashboard loaded successfully!');
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
